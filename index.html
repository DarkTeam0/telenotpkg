<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AkMods Referral + OTP System</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      color: white;
      text-align: center;
      padding: 20px;
    }
    .card {
      max-width: 400px;
      margin: auto;
      background: rgba(0,0,0,0.5);
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0px 0px 20px #000;
    }
    button {
      padding: 10px 20px;
      margin: 8px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      background: #ff512f;
      color: white;
      transition: 0.3s;
    }
    button:hover { background: #dd2476; }
    input {
      width: 80%;
      padding: 10px;
      margin: 10px;
      border-radius: 8px;
      border: none;
      font-size: 16px;
    }
    #telegramBtn {
      background: #0088cc;
    }
  </style>
</head>
<body onload="checkReferral()">

  <!-- Referral Page -->
  <div id="referralPage" class="card">
    <h1>Referral System</h1>
    <p id="counter">0/3 referrals completed</p>
    <p>
      <a id="refLink" href="#" target="_blank" style="color:#4cafef;">Referral link yaha show hoga</a>
    </p>
    <button onclick="showReferralLink()">Generate My Referral Link</button>
    <button onclick="copyReferralLink()">Copy Referral Link</button>
    <button id="telegramBtn" onclick="openTelegram()">Join Telegram</button>
  </div>

  <!-- Number Page -->
  <div id="numberPage" class="card" style="display:none;">
    <h2>Enter Your Number</h2>
    <input type="text" id="phone" placeholder="Enter number">
    <br>
    <button onclick="goToOtp()">Continue</button>
  </div>

  <!-- OTP Generator Page -->
  <div id="otpPage" class="card" style="display:none;">
    <h2>Generate OTP</h2>
    <button onclick="generateOtp()">Generate OTP</button>
    <p id="generatedOtp" style="font-size:20px; margin-top:10px;"></p>
    <input type="text" id="otpInput" placeholder="Enter OTP">
    <br>
    <button onclick="verifyOtp()">Verify OTP</button>
  </div>

<script>
let referralCount = parseInt(localStorage.getItem('refCount') || 0);
let myCode = localStorage.getItem('myReferralCode');
let currentOtp = "";

// generate referral code
function generateReferralCode() {
  let code = 'REF' + Math.floor(Math.random() * 10000);
  localStorage.setItem('myReferralCode', code);
  return code;
}

// show referral link
function showReferralLink() {
  let code = localStorage.getItem('myReferralCode') || generateReferralCode();
  let link = "https://akmods-akhackers-projects.vercel.app/?ref=" + code;
  document.getElementById('refLink').innerText = link;
  document.getElementById('refLink').href = link;
  localStorage.setItem('myReferralLink', link);
}

// copy referral link
function copyReferralLink() {
  let link = localStorage.getItem('myReferralLink');
  if(!link){
    alert("Pehle referral link generate karo!");
    return;
  }
  navigator.clipboard.writeText(link).then(() => {
    alert("Referral link copied: " + link);
  });
}

// add referral
function addReferral() {
  referralCount++;
  localStorage.setItem('refCount', referralCount);
  document.getElementById('counter').innerText = referralCount + "/3 referrals completed";
  if(referralCount >= 3){
    alert("3 referrals complete! Continue to number page.");
    document.getElementById('referralPage').style.display = "none";
    document.getElementById('numberPage').style.display = "block";
  }
}

// check referral on load
function checkReferral() {
  const urlParams = new URLSearchParams(window.location.search);
  const ref = urlParams.get('ref');
  myCode = localStorage.getItem('myReferralCode');

  if(ref){
    console.log("Referral detected: ", ref);
    addReferral();
  } else if(myCode) {
    console.log("Apna referral code hai, allowed");
  } else {
    alert("Access Denied! Referral link se hi open karein.");
    window.location.href = "https://akmods-akhackers-projects.vercel.app/";
  }

  document.getElementById('counter').innerText = referralCount + "/3 referrals completed";
}

// number → otp page
function goToOtp() {
  let phone = document.getElementById('phone').value;
  if(phone.length < 10) {
    alert("Valid number daalo!");
    return;
  }
  localStorage.setItem('userPhone', phone);
  document.getElementById('numberPage').style.display = "none";
  document.getElementById('otpPage').style.display = "block";
}

// otp generate
function generateOtp() {
  currentOtp = Math.floor(1000 + Math.random() * 9000).toString();
  document.getElementById('generatedOtp').innerText = "Your OTP: " + currentOtp;
}

// otp verify
function verifyOtp() {
  let entered = document.getElementById('otpInput').value;
  if(entered === currentOtp){
    alert("OTP Verified ✅");
  } else {
    alert("OTP Galat ❌");
  }
}

// telegram button
function openTelegram() {
  window.open("https://t.me/AkMoDsOfIcial", "_blank");
}
</script>
</body>
</html>
